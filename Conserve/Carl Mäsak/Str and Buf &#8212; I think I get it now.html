http://strangelyconsistent.org/blog/str-and-buf-i-think-i-get-it-now
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name=viewport content="width=device-width, initial-scale=1">
    <title>Str and Buf &#8212; I think I get it now :: Strangely Consistent</title>
    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link rel="alternate" title="Strangely Consistent atom feed" href="http://strangelyconsistent.org/blog/feed.atom" type="application/atom+xml">
    <link href='http://fonts.googleapis.com/css?family=OFL+Sorts+Mill+Goudy+TT:italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Molengo' rel='stylesheet' type='text/css'>
    <style type="text/css" media="all"> 
      @import "http://strangelyconsistent.org/blog/css/main.css";
    </style>
  </head>
  <body>
    <header>
      <hgroup>
        <h1><a href="/">Strangely Consistent</a></h1>
        <h2>Theory, practice, and languages, braided together</h2>
      </hgroup>
      <nav>
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/about">About</a></li>
          <li><a href="http://strangelyconsistent.org/blog/list-of-posts">Archive</a></li>
        </ul>
      </nav>
    </header>

    <article>
  <header>
    <div class="postinfo">
      <div><time datetime="2009-07-06T16:06:00+02:00" pubdate="pubdate">6 Jul, 2009</time></div>
      <div>by Carl Mäsak</div>
      <div><a href="/no-comments">no notes</a></div>
    </div>
    <h1><a href="http://strangelyconsistent.org/blog/str-and-buf-i-think-i-get-it-now">Str and Buf &#8212; I think I get it now</a></h1>
  </header>

  <p>So <code>Str</code> and <code>Buf</code> aren't merely there in Perl 6 to separate out the two related concepts "sequence of characters" and "sequence of bytes", respectively. They're there to institute a <a href="http://en.wikipedia.org/wiki/Linguistic_relativity">whorfian discipline</a> where <strong>it won't even be possible to think the wrong thoughts,</strong> about strings and sequences of bytes.</p>

<p>This is the natural consequence of working Joel Spolsky's <a href="http://www.joelonsoftware.com/articles/Unicode.html">"There Ain't No Such Thing As Plain Text"</a> into the language design. By all means, treat real strings as <code>Str</code>, but make sure byte sequences can't cross that moat without being decoded somehow. Perl 5 totally blurs the distinction, as <a href="http://perlgeek.de/en/article/encodings-and-unicode">moritz++ explains</a>. It is not alone among programming languages in that respect. In fact, I'd be interested to hear about some language that makes the same <code>Str</code>/<code>Buf</code> distinction as Perl 6.</p>

<p>It took me a while to reach this point, but now it seems perfectly obvious. I remember, only a few weeks ago, being shook by TimToady's claim that <code>Str</code>s do not know their byte sequence in the general case. But I see it now. <strong>A Perl 6 string is not a sequence of bytes.</strong> It's a sequence of characters, at least by default. Likewise, a <code>Buf</code> is not a sequence of characters, not even metaphorically. It's a sequence of integer values. And the difference isn't some picky play with words, but the encoding/decoding step itself.</p>

<p>This is the act of building knowledge into the class hierarchy of the language itself, so that people's thoughts will be channeled in the right direction. "Arrgh, why can't I get the number of bytes on this <code>Str</code> object? Oh look, the manual says I have to convert to <code>Buf</code> to do that. Oh look, I have to supply an <code>$encoding</code> parameter to do that. I don't see why, but fair enough — if that's the price for using all the other cool stuff in Perl 6."</p>

<p>The battle of encoding-aware programs is won, not necessarily through making the programmers aware of encodings, but through making the language provide primitives that Do The Right Thing.</p>

</article>

  </body>
</html>
