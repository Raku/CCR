https://donaldh.wtf/2020/05/ipv4-partition/
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>IPv4 Partition</title>
  <meta property="og:title" content="IPv4 Partition" />
  <meta name="twitter:title" content="IPv4 Partition" />
  <meta name="description" content="
This is a solution to task #2 from the 61st Perl Weekly Challenge, written in Raku.">
  <meta property="og:description" content="
This is a solution to task #2 from the 61st Perl Weekly Challenge, written in Raku.">
  <meta name="twitter:description" content="
This is a solution to task #2 from the 61st Perl Weekly Challenge, written in Raku.">
  <meta name="author" content="Donald Hunter"/>
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@donaldhunter" />
  <meta name="twitter:creator" content="@donaldhunter" />
  <meta property="og:url" content="https://donaldh.wtf/2020/05/ipv4-partition/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="donaldh.wtf" />

  <meta name="generator" content="Hugo 0.80.0" />
  <link rel="canonical" href="https://donaldh.wtf/2020/05/ipv4-partition/" />
  <link rel="alternate" href="https://donaldh.wtf/index.xml" type="application/rss+xml" title="donaldh.wtf">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="https://donaldh.wtf/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="https://donaldh.wtf/css/monokai.css" /><link rel="stylesheet" href="https://donaldh.wtf/css/codeblock.css" />



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://donaldh.wtf/">donaldh.wtf</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Categories" href="/categories">Categories</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/tags">Tags</a>
            </li>
          
        
          
            <li>
              <a title="About" href="/about/">About</a>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
      </div>
    </div>

  </div>
</nav>




    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              <h1>IPv4 Partition</h1>
                
                
                  <span class="post-meta">
  
  
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on May 18, 2020
  
  
  
</span>

                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p>
This is a solution to task #2 from the <a href="https://perlweeklychallenge.org/blog/perl-weekly-challenge-061/">61st Perl Weekly Challenge</a>, written in Raku.</p>
<blockquote>
<p>You are given a string containing only digits (0..9). The string should have between 4 and 12
digits.</p>
<p>
Write a script to print every possible valid IPv4 address that can be made by partitioning the
input string.</p>
<p>
For the purpose of this challenge, a valid IPv4 address consists of four “octets” i.e. A, B, C
and D, separated by dots (.).</p>
<p>
Each octet must be between 0 and 255, and must not have any leading zeroes. (e.g., 0 is OK, but
01 is not.)</p>
</blockquote>
<div id="outline-container-headline-1" class="outline-4">
<h4 id="headline-1">
Matching IP addresses
</h4>
<div id="outline-text-headline-1" class="outline-text-4">
<p>
This challenge looks like it can be solved using regular expressions. Let&#39;s start by defining a
regex for valid IP addresses.</p>
<div class="src src-raku">
<pre><code class="language-raku" data-lang="raku">  my $regex = / ^ ( &#39;25&#39; &lt;[0..5]&gt;          # 25n - covers 250 to 255
                    | [
                        [ &#39;2&#39; &lt;[0..4]&gt;     # 2n. – covers 20n to 24n
                          | &#39;1&#39; &lt;[0..9]&gt;   # 1n. – covers 10n to 19n
                          | &lt;[1..9]&gt;       #  n. – covers  1n to  9n
                        ]?                 # ^^  – optional
                        &lt;[0..9]&gt; ]         #   n – last digit for 0 to 249
                  ) ** 4 % &#39;.&#39; $ /;        # ^^^ x 4 separated by &#39;.&#39;

  for &lt;0.0.0.0 1.1.1.1 10.0.0.1 10.10.10.10 192.168.1.254 199.199.199.199 201.201.201.201
       249.249.249.249 250.250.250.250 255.255.255.255 1.1.1.1. 1.01.1.1 1.2.3.256
       256.1.1.1 1..3.4 1.2.3.4.5 1.1.1.01&gt; -&gt; $candidate {
      say &#34;{$candidate} is {$candidate ~~ $regex ?? &#34;an IP address&#34; !! &#34;not valid&#34;}&#34;;
  }</code></pre>
</div>
<pre class="example">
0.0.0.0 is an IP address
1.1.1.1 is an IP address
10.0.0.1 is an IP address
10.10.10.10 is an IP address
192.168.1.254 is an IP address
199.199.199.199 is an IP address
201.201.201.201 is an IP address
249.249.249.249 is an IP address
250.250.250.250 is an IP address
255.255.255.255 is an IP address
1.1.1.1. is not valid
1.01.1.1 is not valid
1.2.3.256 is not valid
256.1.1.1 is not valid
1..3.4 is not valid
1.2.3.4.5 is not valid
1.1.1.01 is not valid
</pre>
<p>
This is the classic regex for matching valid octets, combined with the Raku quantifier separator
<code>%</code> to mach octets separated by <code>.</code>.</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-4">
<h4 id="headline-2">
A Simpler Regex
</h4>
<div id="outline-text-headline-2" class="outline-text-4">
<p>
We should be able to simplify the regex by using a code block to validate the octet range, but sadly it&#39;s
not quite strict enough so the code below allows leading zeros:</p>
<div class="src src-raku">
<pre><code class="language-raku" data-lang="raku">  my $regex = / ^ ( \d ** 1..3 &lt;?{ $/.Int &lt; 256 }&gt; ) ** 4 % &#39;.&#39; $ /;

  for &lt;192.168.1.1 1.01.1.1 1.2.3.256&gt; -&gt; $candidate {
      say &#34;{$candidate} is {$candidate ~~ $regex ?? &#34;an IP address&#34; !! &#34;not valid&#34;}&#34;;
  }</code></pre>
</div>
<pre class="example">
192.168.1.1 is an IP address
1.01.1.1 is an IP address
1.2.3.256 is not valid
</pre>
</div>
</div>
<div id="outline-container-headline-3" class="outline-4">
<h4 id="headline-3">
A Working Regex
</h4>
<div id="outline-text-headline-3" class="outline-text-4">
<p>
This next avoids matching leading zeros by ensuring that the leftmost digit in a 2 or 3 digit number
will only match <code>1..9</code>.</p>
<div class="src src-raku">
<pre><code class="language-raku" data-lang="raku">  my $regex = / ^ ( [ &lt;[1..9]&gt; \d? ]? \d &lt;?{ $/.Int &lt; 256 }&gt; ) ** 4 % &#39;.&#39; $ /;

  for &lt;192.168.1.1 1.01.1.1 10.109.0.1 10.0.0.1&gt; -&gt; $candidate {
      say &#34;{$candidate} is {$candidate ~~ $regex ?? &#34;an IP address&#34; !! &#34;not valid&#34;}&#34;;
  }</code></pre>
</div>
<pre class="example">
192.168.1.1 is an IP address
1.01.1.1 is not valid
10.109.0.1 is an IP address
10.0.0.1 is an IP address
</pre>
</div>
</div>
<div id="outline-container-headline-4" class="outline-4">
<h4 id="headline-4">
The Challenge
</h4>
<div id="outline-text-headline-4" class="outline-text-4">
<p>
Making use of this regex, I adapted it to the IPv4 partition problem by first dropping the <code>.</code>
separator and then using the <code>:exhaustive</code> adverb to find all possible matches.</p>
<div class="src src-raku">
<pre><code class="language-raku" data-lang="raku">  multi find-ips(Str $input where / \d ** 4..12 /) {
      gather {
          take .list.flat.join(&#39;.&#39;)
          for $input ~~ m:exhaustive
              / ^ ( &lt;[1..9]&gt; ** 0..2 \d &lt;?{ $/.Int &lt; 256 }&gt; ) ** 4 $ /
      }
  }</code></pre>
</div>
<p>
I added a <code>multi</code> variant to catch invalid input and a <code>MAIN</code> for running it.</p>
<div class="src src-raku">
<pre><code class="language-raku" data-lang="raku">  multi find-ips(Str $input) {
      note &#34;Sorry: {$input} is not a valid input, it should be 4 to 12 digits.&#34;;
      exit 1
  }

  sub MAIN(Str $input) {
      CATCH { default { .say } }

      my @ips = find-ips($input);
      say &#34;Found {+@ips} potential IP address{+@ips == 1 ?? &#39;&#39; !! &#39;es&#39;} in {$input}:&#34;;
      say @ips.join(&#34;\n&#34;).indent(4);
  }</code></pre>
</div>
<div class="src src-sh">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">./ipv4-partition.raku <span style="color:#ae81ff">25525511135</span></code></pre></div>
</div>
<pre class="example">
Found 2 potential IP addresses in 25525511135:
    255.255.111.35
    255.255.11.135
</pre>
<div class="src src-sh">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">./ipv4-partition.raku <span style="color:#ae81ff">4444</span></code></pre></div>
</div>
<pre class="example">
Found 1 potential IP address in 4444:
    4.4.4.4
</pre>
<div class="src src-sh">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">./ipv4-partition.raku <span style="color:#ae81ff">11</span></code></pre></div>
</div>
<pre class="example">
Sorry: 11 is not a valid input, it should be 4 to 12 digits.
</pre>
<div class="src src-sh">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">./ipv4-partition.raku <span style="color:#ae81ff">19216812</span></code></pre></div>
</div>
<pre class="example">
Found 9 potential IP addresses in 19216812:
    192.168.1.2
    192.16.81.2
    192.16.8.12
    192.1.68.12
    19.216.81.2
    19.216.8.12
    19.21.68.12
    19.2.168.12
    1.92.168.12
</pre>
</div>
</div>

        
          <div class="blog-tags">
            
              <a href="https://donaldh.wtf//tags/challenge/">challenge</a>&nbsp;
            
              <a href="https://donaldh.wtf//tags/raku/">raku</a>&nbsp;
            
          </div>
        

        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://donaldh.wtf/2020/05/excel-columns/" data-toggle="tooltip" data-placement="top" title="Excel Columns">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="https://donaldh.wtf/2020/06/combinations/" data-toggle="tooltip" data-placement="top" title="Combinations">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      
        
          <div class="disqus-comments">
            <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "donaldh-wtf" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
          </div>
        
        
      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="https://github.com/donaldh" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/donaldhunter" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://stackoverflow.com/users/386025" title="StackOverflow">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.instagram.com/donaldihunter" title="Instagram">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-instagram fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.flickr.com/people/sealgair" title="Flickr">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-flickr fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              Donald Hunter
            
          

          &nbsp;&bull;&nbsp;
          2021

          
            &nbsp;&bull;&nbsp;
            <a href="https://donaldh.wtf/">donaldh.wtf</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.80.0</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://donaldh.wtf/js/main.js"></script>
<script src="https://donaldh.wtf/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function() {$("pre.chroma").css("padding","0");}); </script><script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script>
<script src="https://donaldh.wtf/js/load-photoswipe.js"></script>






  </body>
</html>

